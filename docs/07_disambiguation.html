<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Введение в cg3: разрешение морфологической неоднозначности – Конечные автоматы в морфологическом анализе 2025/2026</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./08_coverage.html" rel="next">
<link href="./06_transducer_manipulation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-320ad5607646c56df2c4e55503b78b49.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Поиск не дал результатов",
    "search-matching-documents-text": "Результаты поиска",
    "search-copy-link-title": "Скопировать ссылку",
    "search-hide-matches-text": "Скрыть дополнительные результаты",
    "search-more-match-text": "дополнительный результат в этом документе",
    "search-more-matches-text": "дополнительных результата(-ов) в этом документе",
    "search-clear-button-title": "Очистить",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Отменить",
    "search-submit-button-title": "Найти",
    "search-label": "Поиск"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Переключить боковую панель навигации" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07_disambiguation.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Введение в <code>cg3</code>: разрешение морфологической неоднозначности</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Переключить боковую панель навигации" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Поиск" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Конечные автоматы в морфологическом анализе 2025/2026</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/agricolamz/2026_morphological_transducers/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Поиск"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Введение</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_introduction_to_transducers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Автоматический морфологический анализ</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_introduction_to_lexd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Введение в <code>lexd</code>: морфология</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_phonological_rules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Введение в <code>twol</code>: (мор)фонология</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_language_tasks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Моделирование языковых явлений</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_technical_class.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Введение в командную строку</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_transducer_manipulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Операции с трансдьюсерами</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_disambiguation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Введение в <code>cg3</code>: разрешение морфологической неоднозначности</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_coverage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Метрики качества</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_hygiene.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Как распространять работу?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Список литературы</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Содержание</h2>
   
  <ul>
  <li><a href="#constraint-grammar" id="toc-constraint-grammar" class="nav-link active" data-scroll-target="#constraint-grammar"><span class="header-section-number">7.1</span> Constraint grammar</a></li>
  <li><a href="#cg3" id="toc-cg3" class="nav-link" data-scroll-target="#cg3"><span class="header-section-number">7.2</span> <code>cg3</code></a>
  <ul class="collapse">
  <li><a href="#первый-пример" id="toc-первый-пример" class="nav-link" data-scroll-target="#первый-пример"><span class="header-section-number">7.2.1</span> Первый пример</a></li>
  <li><a href="#структура-.cg3-файла" id="toc-структура-.cg3-файла" class="nav-link" data-scroll-target="#структура-.cg3-файла"><span class="header-section-number">7.2.2</span> Структура <code>.cg3</code> файла</a></li>
  <li><a href="#списки-и-операции-над-ними" id="toc-списки-и-операции-над-ними" class="nav-link" data-scroll-target="#списки-и-операции-над-ними"><span class="header-section-number">7.2.3</span> Списки и операции над ними</a></li>
  <li><a href="#операции-с-чтениями" id="toc-операции-с-чтениями" class="nav-link" data-scroll-target="#операции-с-чтениями"><span class="header-section-number">7.2.4</span> Операции с чтениями</a></li>
  <li><a href="#операции-с-тегами" id="toc-операции-с-тегами" class="nav-link" data-scroll-target="#операции-с-тегами"><span class="header-section-number">7.2.5</span> Операции с тегами</a></li>
  <li><a href="#контекстные-тесты" id="toc-контекстные-тесты" class="nav-link" data-scroll-target="#контекстные-тесты"><span class="header-section-number">7.2.6</span> Контекстные тесты</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Введение в <code>cg3</code>: разрешение морфологической неоднозначности</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<section id="constraint-grammar" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="constraint-grammar"><span class="header-section-number">7.1</span> Constraint grammar</h2>
<p>Парадигма Constraint grammar (CG) <span class="citation" data-cites="karlsson1995 bick15">(<a href="references.html#ref-karlsson1995" role="doc-biblioref">Karlsson и др. 1995</a>; <a href="references.html#ref-bick15" role="doc-biblioref">Bick и Didriksen 2015</a>)</span> — это правиловая процедурная система обработки текста, позволяющая решать достаточно большой набор разнообразных задач, такие как</p>
<ul>
<li>разрешение неоднозначности;</li>
<li>приписывание тэгов, например, синтаксических ролей;</li>
<li>разрешение анафоры;</li>
<li>построение деревьев зависимостей;</li>
<li>chunking — выделение границ синтаксических единиц (без внутренней структуры, отношений вершины-зависимое и т. п.) <span class="citation" data-cites="bick2013">(<a href="references.html#ref-bick2013" role="doc-biblioref">Bick 2013</a>)</span>;</li>
<li>и многие другие.</li>
</ul>
<p>CG разрабатывалась начиная с 1980-ых Фредом Карлссоном и другими в университете Хельсинки. С самого начала эта парадигма задумывалась как модуль, который работает с любым текстом на любом языке, так что каждой входной единице сопоставляется некоторая выходная единица (включая пунктуацию и другие топографические особенности). Слово <em>constraint</em> в описании подчеркивает фильтрующую функцию, которую носит CG модуль: на вход мы подаем некоторый текст и морфологические разборы, а CG модуль удаляет, изменяет или модифицирует морфологические разборы.</p>
<p>Важно отметить, что CG правила легко соединяются вместе с морфологическими трансдьюсерами, но они так же работают и в других фреймворках: пока я готовился к этой лекции, я нашел <code>.cg3</code> файл в репозитории, в котором использовался <code>uniparser</code> Тимофея Архангельского.</p>
<p>Отмечу неожиданное преимущество правиловых фреймворков: их достаточно легко превращать в текст, объясняющий процедуру. Попытку сделать такое для правил CG можно посмотреть в следующей работе <span class="citation" data-cites="swanson25">(<a href="references.html#ref-swanson25" role="doc-biblioref">Swanson 2025</a>)</span>.</p>
</section>
<section id="cg3" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="cg3"><span class="header-section-number">7.2</span> <code>cg3</code></h2>
<p>В наших лекциях для разрешения морфологической неоднозначности мы будем использовать <code>cg3</code> (полное название <code>vislcg3</code>). <code>VISL</code> (Visual Interactive Syntax Learning) — подпроект датской компании GrammarSoft ApS, а <code>CG3</code> обозначает новую, третью, версию реализации парадигмы. Чтобы установить достаточно следующих команд.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> curl <span class="at">-s</span> https://apertium.projectjj.com/apt/install-nightly.sh <span class="kw">|</span> <span class="fu">sudo</span> bash</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo apt-get install cg3</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Первая команда добавляет в операционную систему новый источник программ, он такой же как и для команд <code>lexd</code> и <code>twol</code>. Вторая команда — стандартный способ установить программу. У программы есть большая <a href="https://edu.visl.dk/cg3/chunked/index.html">документация</a>, но начинается она со следующего предостережения:</p>
<blockquote class="blockquote">
<p>This manual should be regarded as a guideline. Some of the features or functionality described is either not implemented yet, or does not work exactly as advertised. A good place to see what is and is not implemented is to run the regression test suite as the test names are indicative of features. The individual tests are also good starting points to find examples on how a specific feature works.</p>
</blockquote>
<p><code>cg3</code> по умолчанию угадывает формат, в котором ей поступают данные на вход и отдает в таком же формате. Однако есть и программы более узкого назначения:</p>
<ul>
<li><code>cg-conv</code> — программа для преобразования входных/выходных типов данных (например, между апертиумовским и CG) ;</li>
<li><code>cg-comp</code> компилирует файл CG правил в бинарный файл ;</li>
<li><code>cg-proc</code> обрабатывает входные данные при помощи файла CG правил или его бинарного варианта ;</li>
<li>и некоторые другие.</li>
</ul>
<p>В программе <code>cg3</code> достаточно много аргументов (см. <code>cg3 -h</code>), нам важно три:</p>
<ul>
<li><code>-g</code> — указывает файл с CG правилами ;</li>
<li><code>-I</code> — файл для чтения вместо стандартного stdin ;</li>
<li><code>-O</code> — файл для записи результата работы вместо стандартного stdout.</li>
</ul>
<section id="первый-пример" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="первый-пример"><span class="header-section-number">7.2.1</span> Первый пример</h3>
<p>Рассмотрим такой трансдьюсер, записанный в <code>example_1.lexd</code>:</p>
<div id="61373fe1" class="cell" data-execution_count="1">
<div class="cell-output cell-output-stdout">
<pre><code>PATTERNS
Preposition
Noun
Verb

LEXICON Preposition
в&lt;pr&gt;:в

LEXICON Noun
город&lt;n&gt;&lt;nom&gt;&lt;sg&gt;:город
город&lt;n&gt;&lt;acc&gt;&lt;sg&gt;:город
поезд&lt;n&gt;&lt;nom&gt;&lt;sg&gt;:поезд

LEXICON Verb
ехать&lt;v&gt;&lt;npst&gt;&lt;p3&gt;&lt;sg&gt;:едет</code></pre>
</div>
</div>
<p>Мы его можем скомпилировать в оптимизированный:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> lexd example_1.lexd <span class="kw">|</span> <span class="ex">hfst-txt2fst</span> <span class="kw">|</span> <span class="ex">hfst-invert</span> <span class="kw">|</span> <span class="ex">hfst-fst2fst</span> <span class="at">-O</span> <span class="at">-o</span> analyzer.hfstol</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Подадим предложение на вход процессору:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"Поезд едет в город."</span> <span class="kw">|</span> <span class="ex">hfst-proc</span> analyzer.hfstol</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="3c8208d3" class="cell" data-execution_count="3">
<div class="cell-output cell-output-stdout">
<pre><code>^Поезд/Поезд&lt;n&gt;&lt;nom&gt;&lt;sg&gt;$ ^едет/ехать&lt;v&gt;&lt;npst&gt;&lt;p3&gt;&lt;sg&gt;$ ^в/в&lt;pr&gt;$ ^город/город&lt;n&gt;&lt;acc&gt;&lt;sg&gt;/город&lt;n&gt;&lt;nom&gt;&lt;sg&gt;$.</code></pre>
</div>
</div>
<p>Апертиумовский формат неудобно читать, так что добавим флаг <code>-C</code>, чтобы <code>hfst-proc</code> преобразовал получившееся в CG формат:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"Поезд едет в город."</span> <span class="kw">|</span> <span class="ex">hfst-proc</span> <span class="at">-C</span> analyzer.hfstol</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="d27a262b" class="cell" data-execution_count="4">
<div class="cell-output cell-output-stdout">
<pre><code>"&lt;Поезд&gt;"
    "поезд" n nom sg
"&lt;едет&gt;"
    "ехать" v npst p3 sg
"&lt;в&gt;"
    "в" pr
"&lt;город&gt;"
    "город" n acc sg
    "город" n nom sg</code></pre>
</div>
</div>
<p>Мы видим, что форма <em>город</em> имеет два возможных разбора. Кроме того мы видим, что один из разборов точно неправильный. Для того чтобы убрать ненужный разбор, создадим следующий файл <code>example_1.cg3</code>:</p>
<div id="0516d9f3" class="cell" data-execution_count="5">
<div class="cell-output cell-output-stdout">
<pre><code>REMOVE (nom) IF (-1C (pr)) ;</code></pre>
</div>
</div>
<p>Применим написанное правило к нашему трансдьюсеру:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"Поезд едет в город."</span> <span class="kw">|</span> <span class="ex">hfst-proc</span> <span class="at">-C</span> analyzer.hfstol <span class="kw">|</span> <span class="ex">cg3</span> <span class="at">-g</span> example_1.cg3</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="0f6aa141" class="cell" data-execution_count="6">
<div class="cell-output cell-output-stdout">
<pre><code>Warning: No soft or hard delimiters defined in grammar. Hard limit of 500 cohorts may break windows in unintended places.
"&lt;Поезд&gt;"
    "поезд" n nom sg
"&lt;едет&gt;"
    "ехать" v npst p3 sg
"&lt;в&gt;"
    "в" pr
"&lt;город&gt;"
    "город" n acc sg</code></pre>
</div>
</div>
<p>Таким образом мы избавились от ненужного разбора. В следующих разделах мы углубимся в возможности <code>cg3</code>.</p>
</section>
<section id="структура-.cg3-файла" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="структура-.cg3-файла"><span class="header-section-number">7.2.2</span> Структура <code>.cg3</code> файла</h3>
<p>Файлы с CG правилами принято записывать в файлы с расширениями <code>.cg3</code> или <code>.rlx</code>. В принципе никакой необходимой структуры такие файлы не предполагают, однако для читаемости имеет смысл делить логические фрагменты на разделы <code>SECTION</code>. Такие разделы могут иметь названия. Кроме того можно вводить специальные разделы <code>BEFORE-SECTIONS</code> и <code>AFTER-SECTIONS</code>, которые будут запускаться до и перед разделами <code>SECTION</code>. Также для отлаживания кода полезно знать команду <code>END</code>, после которой правила из файла не читаются. Содержание файла обычно заключается в наборе команд для декларации переменных при помощи команд <code>LIST</code> и <code>SET</code> и манипуляции</p>
<ul>
<li>с тегами;</li>
<li>чтениями;</li>
<li>зависимостями;</li>
<li>отношениями;</li>
<li>единицами анализа (в формализме CG их называют <em>когортами</em>, <em>cohort</em>);</li>
<li>и др.</li>
</ul>
<p>Комментарии отделяются при помощи знака <code>#</code>.</p>
<p>Кроме того, есть некоторый <a href="https://edu.visl.dk/cg3/chunked/grammar.html#grammar-options">набор настроек</a> для чтения грамматики, который добавляется при помощи команды <code>OPTIONS</code>.</p>
<p>Вот фрагменты искусственного <code>.сg3</code> файла, который приводиться здесь для иллюстрации:</p>
<div class="sourceCode" id="annotated-cell-6"><pre class="sourceCode markdown code-annotation-code code-with-copy code-annotated"><code class="sourceCode markdown"><span id="annotated-cell-6-1"><a href="#annotated-cell-6-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{cg3}</span></span>
<span id="annotated-cell-6-2"><a href="#annotated-cell-6-2" aria-hidden="true" tabindex="-1"></a>DELIMITERS <span class="op">=</span> <span class="st">"&lt;.&gt;"</span> <span class="st">"&lt;!&gt;"</span> <span class="st">"&lt;?&gt;"</span> <span class="st">"&lt;...&gt;"</span><span class="op">;</span></span>
<span id="annotated-cell-6-3"><a href="#annotated-cell-6-3" aria-hidden="true" tabindex="-1"></a>OPTIONS <span class="op">+=</span> addcohort<span class="op">-</span>attach <span class="op">;</span></span>
<span id="annotated-cell-6-4"><a href="#annotated-cell-6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-6-5"><a href="#annotated-cell-6-5" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;...&gt;</span></span>
<span id="annotated-cell-6-6"><a href="#annotated-cell-6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-6-7"><a href="#annotated-cell-6-7" aria-hidden="true" tabindex="-1"></a><span class="pp"># </span><span class="er">важный комментарий</span></span>
<span id="annotated-cell-6-8"><a href="#annotated-cell-6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-6-9"><a href="#annotated-cell-6-9" aria-hidden="true" tabindex="-1"></a>LIST Det <span class="op">=</span> art <span class="op">;</span></span>
<span id="annotated-cell-6-10"><a href="#annotated-cell-6-10" aria-hidden="true" tabindex="-1"></a>LIST PRON <span class="op">=</span> prde prps prn <span class="op">;</span></span>
<span id="annotated-cell-6-11"><a href="#annotated-cell-6-11" aria-hidden="true" tabindex="-1"></a>SET Sem<span class="op">/</span>Time <span class="op">=</span> Month <span class="op">|</span> Months <span class="op">|</span> Year <span class="op">|</span> Century <span class="op">|</span> Season <span class="op">|</span> Seasons <span class="op">|</span> TimeOfDay <span class="op">;</span> </span>
<span id="annotated-cell-6-12"><a href="#annotated-cell-6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-6-13"><a href="#annotated-cell-6-13" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;...&gt;</span></span>
<span id="annotated-cell-6-14"><a href="#annotated-cell-6-14" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-6-15" class="code-annotation-target"><a href="#annotated-cell-6-15" aria-hidden="true" tabindex="-1"></a>SECTION</span>
<span id="annotated-cell-6-16"><a href="#annotated-cell-6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-6-17"><a href="#annotated-cell-6-17" aria-hidden="true" tabindex="-1"></a>REMOVE Dat IF <span class="op">(</span>NOT <span class="dv">0</span> Anim OR Cog OR Ant<span class="op">)</span> <span class="op">(</span>NOT <span class="dv">0</span> Pron<span class="op">)</span> <span class="op">;</span></span>
<span id="annotated-cell-6-18"><a href="#annotated-cell-6-18" aria-hidden="true" tabindex="-1"></a>SELECT Gen IF <span class="op">(</span><span class="dv">0</span><span class="er">C</span> N<span class="op">)</span> <span class="op">(-</span><span class="dv">1</span><span class="er">C</span> A OR Det<span class="op">)</span> <span class="op">;</span></span>
<span id="annotated-cell-6-19"><a href="#annotated-cell-6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-6-20"><a href="#annotated-cell-6-20" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;...&gt;</span></span>
<span id="annotated-cell-6-21"><a href="#annotated-cell-6-21" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-6-22" class="code-annotation-target"><a href="#annotated-cell-6-22" aria-hidden="true" tabindex="-1"></a>SECTION some<span class="op">-</span>other<span class="op">-</span>forms <span class="op">;</span></span>
<span id="annotated-cell-6-23"><a href="#annotated-cell-6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-6-24"><a href="#annotated-cell-6-24" aria-hidden="true" tabindex="-1"></a>REMOVE Imper IF <span class="op">(</span><span class="dv">1</span><span class="er">C</span> Fin<span class="op">)</span> <span class="op">;</span></span>
<span id="annotated-cell-6-25"><a href="#annotated-cell-6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-6-26"><a href="#annotated-cell-6-26" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;...&gt;</span></span>
<span id="annotated-cell-6-27"><a href="#annotated-cell-6-27" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="15" data-code-annotation="1">Если раздел <code>SECTION</code> не поименована, то можно не ставить точки с запятой.</span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="22" data-code-annotation="2">Если раздел <code>SECTION</code> поименован, то а) в названии не должно быть пробелов б) строка должна заканчиваться точкой с запятой.</span>
</dd>
</dl>
</section>
<section id="списки-и-операции-над-ними" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="списки-и-операции-над-ними"><span class="header-section-number">7.2.3</span> Списки и операции над ними</h3>
<p>Списки это поименованные переменные, содержащие некоторые объекты. Из примера выше понятно, что объекты в списке разделяются пробелом, а конец списка обозначается точкой с запятой.</p>
<p>Один из первых списков, который даже имеет отдельное название — раздел <code>DELIMITERS</code>. В данном разделе перечисляются единицы, которые останавливают парсинг. Списки <code>DELIMITERS</code> в файлах <code>.cg3</code> на GitHub не отличаются креативностью и обычно содержат вполне ожидаемые</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{cg3}</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>DELIMITERS <span class="op">=</span> <span class="st">"&lt;.&gt;"</span> <span class="st">"&lt;!&gt;"</span> <span class="st">"&lt;?&gt;"</span> <span class="st">"&lt;...&gt;"</span> <span class="op">;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Однако, может быть для ваших задач будет иметь смысл добавить какой-то знак переноса строки, на случай, если будет отсутвовать пунктуация в конце абзаца. Важно отметить, что при отсутствии раздела <code>DELIMITERS</code> в файле с правилами программа <code>cg3</code> выдает предупреждение.</p>
<p>Кроме того, существует раздел <code>SOFT-DELIMITERS</code>, который я видел заполненный только запятой <code>"&lt;,&gt;"</code>.</p>
<p>Остальные списки задаются при помощи команды <code>LIST</code>, после которой следует дать переменной некоторое имя, например,</p>
<div class="sourceCode" id="annotated-cell-8"><pre class="sourceCode markdown code-annotation-code code-with-copy code-annotated"><code class="sourceCode markdown"><span id="annotated-cell-8-1"><a href="#annotated-cell-8-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{cg3}</span></span>
<span id="annotated-cell-8-2"><a href="#annotated-cell-8-2" aria-hidden="true" tabindex="-1"></a>LIST number <span class="op">=</span> sg pl <span class="op">;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-8-3" class="code-annotation-target"><a href="#annotated-cell-8-3" aria-hidden="true" tabindex="-1"></a>LIST number <span class="op">+=</span> du <span class="op">;</span></span>
<span id="annotated-cell-8-4"><a href="#annotated-cell-8-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-8" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="3" data-code-annotation="1">Операция <code>+=</code> добавляет тег или несколько тегов к уже созданному списку, хотя и не понятно, что мешало сразу все задать.</span>
</dd>
</dl>
<p>Функция <code>SET</code> также позволяет задать списки, однако делает это на основании одной из следующих операций или их сочетаний</p>
<ul>
<li>объединение <code>OR</code> и <code>|</code>;</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{cg3}</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>LIST A <span class="op">=</span> a b c d <span class="op">;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>LIST B <span class="op">=</span> c d e f <span class="op">;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>SET new_set <span class="op">=</span> a OR b <span class="op">;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>a b c d e f</code></pre>
<ul>
<li>прямое произведение <code>+</code>;</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{cg3}</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>LIST A <span class="op">=</span> N <span class="op">;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>LIST B <span class="op">=</span> sg du pl <span class="op">;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>SET new_set <span class="op">=</span> a <span class="op">+</span> b <span class="op">;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>(N sg) (N du) (N pl)</code></pre>
<ul>
<li>исключение <code>-</code>;</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{cg3}</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>LIST A <span class="op">=</span> a b c d <span class="op">;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>LIST B <span class="op">=</span> c d e f <span class="op">;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>SET new_set <span class="op">=</span> a <span class="op">-</span> b <span class="op">;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>a b</code></pre>
<ul>
<li>разность <code>\</code>;</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{cg3}</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>LIST A <span class="op">=</span> a b c d <span class="op">;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>LIST B <span class="op">=</span> c d e f <span class="op">;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>SET new_set <span class="op">=</span> a \ b <span class="op">;</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>a b</code></pre>
<ul>
<li>симмитричная разность <code>∆</code> (U+2206);</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{cg3}</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>LIST A <span class="op">=</span> a b c d <span class="op">;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>LIST B <span class="op">=</span> c d e f <span class="op">;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>SET new_set <span class="op">=</span> a ∆ b <span class="op">;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>a b e f</code></pre>
<ul>
<li>пересечение <code>∩</code>;</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{cg3}</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>LIST A <span class="op">=</span> a b c d <span class="op">;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>LIST B <span class="op">=</span> c d e f <span class="op">;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>SET new_set <span class="op">=</span> a ∩ b <span class="op">;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>c d</code></pre>
</section>
<section id="операции-с-чтениями" class="level3" data-number="7.2.4">
<h3 data-number="7.2.4" class="anchored" data-anchor-id="операции-с-чтениями"><span class="header-section-number">7.2.4</span> Операции с чтениями</h3>
<ul>
<li><code>SELECT</code> удаляет все чтения из когорты, кроме тех, что подходят к контексту.</li>
</ul>
<pre><code>SELECT &lt;target&gt; [contextual_tests] ;</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cat example_SELECT.cg3</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="1013823c" class="cell" data-execution_count="7">
<div class="cell-output cell-output-stdout">
<pre><code>SELECT ("город" n acc sg) ;</code></pre>
</div>
</div>
<div class="sourceCode" id="cb27"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"Поезд едет в город."</span> <span class="kw">|</span> <span class="ex">hfst-proc</span> <span class="at">-C</span> analyzer.hfstol <span class="kw">|</span> <span class="ex">cg3</span> <span class="at">-g</span> example_SELECT.cg3</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="6f05f9fb" class="cell" data-execution_count="8">
<div class="cell-output cell-output-stdout">
<pre><code>Warning: No soft or hard delimiters defined in grammar. Hard limit of 500 cohorts may break windows in unintended places.
"&lt;Поезд&gt;"
    "поезд" n nom sg
"&lt;едет&gt;"
    "ехать" v npst p3 sg
"&lt;в&gt;"
    "в" pr
"&lt;город&gt;"
    "город" n acc sg</code></pre>
</div>
</div>
<ul>
<li><code>REMOVE</code> удаляет чтение из когорты. Может удалить даже последнее чтение.</li>
</ul>
<pre><code>REMOVE &lt;target&gt; [contextual_tests] ;</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cat example_REMOVE.cg3</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="95facc69" class="cell" data-execution_count="9">
<div class="cell-output cell-output-stdout">
<pre><code>REMOVE ("город" n nom sg) ;</code></pre>
</div>
</div>
<div class="sourceCode" id="cb32"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"Поезд едет в город."</span> <span class="kw">|</span> <span class="ex">hfst-proc</span> <span class="at">-C</span> analyzer.hfstol <span class="kw">|</span> <span class="ex">cg3</span> <span class="at">-g</span> example_REMOVE.cg3</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="f00587fc" class="cell" data-execution_count="10">
<div class="cell-output cell-output-stdout">
<pre><code>Warning: No soft or hard delimiters defined in grammar. Hard limit of 500 cohorts may break windows in unintended places.
"&lt;Поезд&gt;"
    "поезд" n nom sg
"&lt;едет&gt;"
    "ехать" v npst p3 sg
"&lt;в&gt;"
    "в" pr
"&lt;город&gt;"
    "город" n acc sg</code></pre>
</div>
</div>
<ul>
<li><code>RESTORE</code> восстанавливает чтение удаленное при помощи <code>SELECT</code> или <code>REMOVE</code>. Не работает, если все чтения были удалены.</li>
</ul>
<pre><code>RESTORE &lt;restore_target&gt; &lt;target&gt; [contextual_tests] ;</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cat example_RESTORE.cg3</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="3894e45c" class="cell" data-execution_count="11">
<div class="cell-output cell-output-stdout">
<pre><code>SELECT ("город" n acc sg) ;
RESTORE ("город" n nom sg) ("город" n);</code></pre>
</div>
</div>
<div class="sourceCode" id="cb37"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"Поезд едет в город."</span> <span class="kw">|</span> <span class="ex">hfst-proc</span> <span class="at">-C</span> analyzer.hfstol <span class="kw">|</span> <span class="ex">cg3</span> <span class="at">-g</span> example_RESTORE.cg3</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="2c6bcb98" class="cell" data-execution_count="12">
<div class="cell-output cell-output-stdout">
<pre><code>Warning: No soft or hard delimiters defined in grammar. Hard limit of 500 cohorts may break windows in unintended places.
"&lt;Поезд&gt;"
    "поезд" n nom sg
"&lt;едет&gt;"
    "ехать" v npst p3 sg
"&lt;в&gt;"
    "в" pr
"&lt;город&gt;"
    "город" n acc sg
    "город" n nom sg</code></pre>
</div>
</div>
</section>
<section id="операции-с-тегами" class="level3" data-number="7.2.5">
<h3 data-number="7.2.5" class="anchored" data-anchor-id="операции-с-тегами"><span class="header-section-number">7.2.5</span> Операции с тегами</h3>
<p>Первая группа команд, которую мы рассмотрим, измененяет теги.</p>
<ul>
<li><code>ADD</code> — добавляет тэг к набору тегов, <strong>разрешая</strong> в дальнейшем одной из операций <code>MAP</code>, <code>ADD</code> или <code>REPLACE</code> работать с анализируемым чтением ;</li>
</ul>
<pre><code>ADD &lt;tags&gt; [BEFORE|AFTER &lt;tags&gt;] &lt;target&gt; [contextual_tests] ;</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cat example_ADD.cg3</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="0c19f92c" class="cell" data-execution_count="13">
<div class="cell-output cell-output-stdout">
<pre><code>ADD (NEW_TAG) (v) ;
ADD (ANOTHER_TAG) AFTER (npst) (v) ;</code></pre>
</div>
</div>
<div class="sourceCode" id="cb42"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"Поезд едет в город."</span> <span class="kw">|</span> <span class="ex">hfst-proc</span> <span class="at">-C</span> analyzer.hfstol <span class="kw">|</span> <span class="ex">cg3</span> <span class="at">-g</span> example_ADD.cg3</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="ba24ccdd" class="cell" data-execution_count="14">
<div class="cell-output cell-output-stdout">
<pre><code>Warning: No soft or hard delimiters defined in grammar. Hard limit of 500 cohorts may break windows in unintended places.
"&lt;Поезд&gt;"
    "поезд" n nom sg
"&lt;едет&gt;"
    "ехать" v npst ANOTHER_TAG p3 sg NEW_TAG
"&lt;в&gt;"
    "в" pr
"&lt;город&gt;"
    "город" n acc sg
    "город" n nom sg</code></pre>
</div>
</div>
<ul>
<li><code>MAP</code> — добавляет тэг к набору тегов, <strong>запрещая</strong> в дальнейшем одной из операций <code>MAP</code>, <code>ADD</code> или <code>REPLACE</code> работать с анализируемым чтением ;</li>
</ul>
<pre><code>MAP &lt;tags&gt; [BEFORE|AFTER &lt;tags&gt;] &lt;target&gt; [contextual_tests] ;</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cat example_MAP.cg3</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="c40a4950" class="cell" data-execution_count="15">
<div class="cell-output cell-output-stdout">
<pre><code>MAP (NEW_TAG) (v) ;
ADD (ANOTHER_TAG) AFTER (npst) (v) ;</code></pre>
</div>
</div>
<div class="sourceCode" id="cb47"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"Поезд едет в город."</span> <span class="kw">|</span> <span class="ex">hfst-proc</span> <span class="at">-C</span> analyzer.hfstol <span class="kw">|</span> <span class="ex">cg3</span> <span class="at">-g</span> example_MAP.cg3</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="43abe192" class="cell" data-execution_count="16">
<div class="cell-output cell-output-stdout">
<pre><code>Warning: No soft or hard delimiters defined in grammar. Hard limit of 500 cohorts may break windows in unintended places.
"&lt;Поезд&gt;"
    "поезд" n nom sg
"&lt;едет&gt;"
    "ехать" v npst p3 sg NEW_TAG
"&lt;в&gt;"
    "в" pr
"&lt;город&gt;"
    "город" n acc sg
    "город" n nom sg</code></pre>
</div>
</div>
<ul>
<li><code>SUBSTITUTE</code> — заменяет один набор тэгов на другой набор тэгов. Может быть сделана нулевая замена, для этого следует использовать знак <code>*</code>.</li>
</ul>
<pre><code>SUBSTITUTE &lt;locate tags&gt; &lt;replacement tags&gt; &lt;target&gt; [contextual_tests] ;</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cat example_SUBSTITUTE.cg3</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="43982447" class="cell" data-execution_count="17">
<div class="cell-output cell-output-stdout">
<pre><code>SUBSTITUTE (sg) (SG) (v) ;
SUBSTITUTE (nom) (*) ("поезд") ;</code></pre>
</div>
</div>
<div class="sourceCode" id="cb52"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"Поезд едет в город."</span> <span class="kw">|</span> <span class="ex">hfst-proc</span> <span class="at">-C</span> analyzer.hfstol <span class="kw">|</span> <span class="ex">cg3</span> <span class="at">-g</span> example_SUBSTITUTE.cg3</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="a8e3e8ef" class="cell" data-execution_count="18">
<div class="cell-output cell-output-stdout">
<pre><code>Warning: No soft or hard delimiters defined in grammar. Hard limit of 500 cohorts may break windows in unintended places.
"&lt;Поезд&gt;"
    "поезд" n sg
"&lt;едет&gt;"
    "ехать" v npst p3 SG
"&lt;в&gt;"
    "в" pr
"&lt;город&gt;"
    "город" n acc sg
    "город" n nom sg</code></pre>
</div>
</div>
<ul>
<li><code>REPLACE</code> — оставляет только выделенный тэг, а остальные теги убирает, <strong>запрещая</strong> в дальнейшем одной из операций <code>MAP</code>, <code>ADD</code> или <code>REPLACE</code> работать с анализируемым чтением ;</li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cat example_REPLACE.cg3</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="f543daee" class="cell" data-execution_count="19">
<div class="cell-output cell-output-stdout">
<pre><code>REPLACE (NEW_TAG) (v) ;</code></pre>
</div>
</div>
<div class="sourceCode" id="cb56"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"Поезд едет в город."</span> <span class="kw">|</span> <span class="ex">hfst-proc</span> <span class="at">-C</span> analyzer.hfstol <span class="kw">|</span> <span class="ex">cg3</span> <span class="at">-g</span> example_REPLACE.cg3</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="3a92ac54" class="cell" data-execution_count="20">
<div class="cell-output cell-output-stdout">
<pre><code>Warning: No soft or hard delimiters defined in grammar. Hard limit of 500 cohorts may break windows in unintended places.
"&lt;Поезд&gt;"
    "поезд" n nom sg
"&lt;едет&gt;"
    "ехать" NEW_TAG
"&lt;в&gt;"
    "в" pr
"&lt;город&gt;"
    "город" n acc sg
    "город" n nom sg</code></pre>
</div>
</div>
<ul>
<li><code>UNMAP</code> снимает блокирующее поведение команд <code>MAP</code> и <code>REPLACE</code>. По-умолчанию <code>UNMAP</code> работает только с единственными чтениями, но если хочется чтобы блокировка была снята с нескольких чтений одной формы, стоит добавить <code>UNSAFE</code>.</li>
</ul>
<pre><code>UNMAP &lt;target&gt; [contextual_tests] ;</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cat example_UNMAP.cg3</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="2c2f807f" class="cell" data-execution_count="21">
<div class="cell-output cell-output-stdout">
<pre><code>MAP (NEW_TAG) (v) ;
UNMAP (NEW_TAG) ;
ADD (ANOTHER_TAG) AFTER (npst) (v) ;</code></pre>
</div>
</div>
<div class="sourceCode" id="cb61"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"Поезд едет в город."</span> <span class="kw">|</span> <span class="ex">hfst-proc</span> <span class="at">-C</span> analyzer.hfstol <span class="kw">|</span> <span class="ex">cg3</span> <span class="at">-g</span> example_UNMAP.cg3</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="0739353c" class="cell" data-execution_count="22">
<div class="cell-output cell-output-stdout">
<pre><code>Warning: No soft or hard delimiters defined in grammar. Hard limit of 500 cohorts may break windows in unintended places.
"&lt;Поезд&gt;"
    "поезд" n nom sg
"&lt;едет&gt;"
    "ехать" v npst ANOTHER_TAG p3 sg NEW_TAG
"&lt;в&gt;"
    "в" pr
"&lt;город&gt;"
    "город" n acc sg
    "город" n nom sg</code></pre>
</div>
</div>
<div class="sourceCode" id="cb63"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cat example_UNSAFE.cg3</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="e7339264" class="cell" data-execution_count="23">
<div class="cell-output cell-output-stdout">
<pre><code>MAP (NEW_TAG) ("город" n) ;
UNMAP UNSAFE (NEW_TAG) ;
ADD (ANOTHER_TAG) ("город" n) ;</code></pre>
</div>
</div>
<div class="sourceCode" id="cb65"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"Поезд едет в город."</span> <span class="kw">|</span> <span class="ex">hfst-proc</span> <span class="at">-C</span> analyzer.hfstol <span class="kw">|</span> <span class="ex">cg3</span> <span class="at">-g</span> example_UNSAFE.cg3</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="a23c213b" class="cell" data-execution_count="24">
<div class="cell-output cell-output-stdout">
<pre><code>Warning: No soft or hard delimiters defined in grammar. Hard limit of 500 cohorts may break windows in unintended places.
"&lt;Поезд&gt;"
    "поезд" n nom sg
"&lt;едет&gt;"
    "ехать" v npst p3 sg
"&lt;в&gt;"
    "в" pr
"&lt;город&gt;"
    "город" n acc sg NEW_TAG ANOTHER_TAG
    "город" n nom sg NEW_TAG ANOTHER_TAG</code></pre>
</div>
</div>
<ul>
<li><code>APPEND</code> добавляет новое прочтение к некоторой единице. Следите, чтобы среди добавляемого была начальная форма.</li>
</ul>
<pre><code>APPEND &lt;tags&gt; &lt;target&gt; [contextual_tests] ;</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cat example_APPEND.cg3</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="f5b0d39f" class="cell" data-execution_count="25">
<div class="cell-output cell-output-stdout">
<pre><code>APPEND ("поезд" n nom sg NEW_READING) ("поезд" n) ;
</code></pre>
</div>
</div>
<div class="sourceCode" id="cb70"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"Поезд едет в город."</span> <span class="kw">|</span> <span class="ex">hfst-proc</span> <span class="at">-C</span> analyzer.hfstol <span class="kw">|</span> <span class="ex">cg3</span> <span class="at">-g</span> example_APPEND.cg3</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="ba0354fe" class="cell" data-execution_count="26">
<div class="cell-output cell-output-stdout">
<pre><code>Warning: No soft or hard delimiters defined in grammar. Hard limit of 500 cohorts may break windows in unintended places.
"&lt;Поезд&gt;"
    "поезд" n nom sg
    "поезд" n nom sg NEW_READING
"&lt;едет&gt;"
    "ехать" v npst p3 sg
"&lt;в&gt;"
    "в" pr
"&lt;город&gt;"
    "город" n acc sg
    "город" n nom sg</code></pre>
</div>
</div>
<ul>
<li><code>COPY</code> копирует прочтение и добавляет к нему тег или набор тегов.</li>
</ul>
<pre><code>COPY &lt;extra tags&gt; [EXCEPT &lt;except tags&gt;] [BEFORE|AFTER &lt;tags&gt;] &lt;target&gt; [contextual_tests] ;</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cat example_COPY.cg3</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="48904e4a" class="cell" data-execution_count="27">
<div class="cell-output cell-output-stdout">
<pre><code>COPY (NEW) AFTER (n) ("поезд" n nom sg);</code></pre>
</div>
</div>
<div class="sourceCode" id="cb75"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{shell}</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"Поезд едет в город."</span> <span class="kw">|</span> <span class="ex">hfst-proc</span> <span class="at">-C</span> analyzer.hfstol <span class="kw">|</span> <span class="ex">cg3</span> <span class="at">-g</span> example_COPY.cg3</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="8ef839a2" class="cell" data-execution_count="28">
<div class="cell-output cell-output-stdout">
<pre><code>Warning: No soft or hard delimiters defined in grammar. Hard limit of 500 cohorts may break windows in unintended places.
"&lt;Поезд&gt;"
    "поезд" n nom sg
    "поезд" n NEW nom sg
"&lt;едет&gt;"
    "ехать" v npst p3 sg
"&lt;в&gt;"
    "в" pr
"&lt;город&gt;"
    "город" n acc sg
    "город" n nom sg</code></pre>
</div>
</div>
</section>
<section id="контекстные-тесты" class="level3" data-number="7.2.6">
<h3 data-number="7.2.6" class="anchored" data-anchor-id="контекстные-тесты"><span class="header-section-number">7.2.6</span> Контекстные тесты</h3>
<p>Большинство примеров операций выше имели в своих шаблонах раздел <code>[contextual_tests]</code>, который делает инструменты значительно функциональнее. Во-первых, можно задать контекст справа или слева:</p>
<div class="sourceCode" id="annotated-cell-52"><pre class="sourceCode markdown code-annotation-code code-with-copy code-annotated"><code class="sourceCode markdown"><span id="annotated-cell-52-1"><a href="#annotated-cell-52-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{cg3}</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-52" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-52-2" class="code-annotation-target"><a href="#annotated-cell-52-2" aria-hidden="true" tabindex="-1"></a><span class="op">...</span> <span class="op">(</span><span class="dv">1</span> N<span class="op">)</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-52" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-52-3" class="code-annotation-target"><a href="#annotated-cell-52-3" aria-hidden="true" tabindex="-1"></a><span class="op">...</span> <span class="op">(-</span><span class="dv">2</span><span class="op">*</span> V<span class="op">)</span></span>
<span id="annotated-cell-52-4"><a href="#annotated-cell-52-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-52" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-52" data-code-lines="2" data-code-annotation="1">Есть ли хотя бы одно чтение с тегом <code>N</code> в следующей когорте?</span>
</dd>
<dt data-target-cell="annotated-cell-52" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-52" data-code-lines="3" data-code-annotation="2">Есть ли хотя бы одно чтение с тегом <code>V</code> две или более когорты назад?</span>
</dd>
</dl>
<p>После номера можно добавить <code>C</code>, тогда тест будет исполнятся только в случае если все чтения в когорте соответствуют условию.</p>
<div class="sourceCode" id="annotated-cell-53"><pre class="sourceCode markdown code-annotation-code code-with-copy code-annotated"><code class="sourceCode markdown"><span id="annotated-cell-53-1"><a href="#annotated-cell-53-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{cg3}</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-53" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-53-2" class="code-annotation-target"><a href="#annotated-cell-53-2" aria-hidden="true" tabindex="-1"></a><span class="op">...</span> <span class="op">(</span><span class="dv">1</span>С N<span class="op">)</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-53" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-53-3" class="code-annotation-target"><a href="#annotated-cell-53-3" aria-hidden="true" tabindex="-1"></a><span class="op">...</span> <span class="op">(-</span><span class="dv">2</span>С<span class="op">*</span> V<span class="op">)</span></span>
<span id="annotated-cell-53-4"><a href="#annotated-cell-53-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-53" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-53" data-code-lines="2" data-code-annotation="1">Все ли чтения имеют тег <code>N</code> в следующей когорте?</span>
</dd>
<dt data-target-cell="annotated-cell-53" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-53" data-code-lines="3" data-code-annotation="2">Все ли чтения имеют тег <code>V</code> две или более когорты назад?</span>
</dd>
</dl>
<p>Результат теста можно перевернуть, добавив <code>NOT</code>:</p>
<div class="sourceCode" id="annotated-cell-54"><pre class="sourceCode markdown code-annotation-code code-with-copy code-annotated"><code class="sourceCode markdown"><span id="annotated-cell-54-1"><a href="#annotated-cell-54-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{cg3}</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-54" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-54-2" class="code-annotation-target"><a href="#annotated-cell-54-2" aria-hidden="true" tabindex="-1"></a><span class="op">...</span> <span class="op">(</span>NOT <span class="dv">1</span> N<span class="op">)</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-54" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-54-3" class="code-annotation-target"><a href="#annotated-cell-54-3" aria-hidden="true" tabindex="-1"></a><span class="op">...</span> <span class="op">(</span>NOT <span class="op">-</span><span class="dv">2</span><span class="op">*</span> V<span class="op">)</span></span>
<span id="annotated-cell-54-4"><a href="#annotated-cell-54-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-54" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-54" data-code-lines="2" data-code-annotation="1">В следующей когорте не должно быть чтения с тегом <code>N</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-54" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-54" data-code-lines="3" data-code-annotation="2">Две и более когорты назад не должно быть чтения с тегом <code>V</code>.</span>
</dd>
</dl>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Задание 07_01
</div>
</div>
<div class="callout-body-container callout-body">
<p>Напишите <code>cg3</code> правила, которые в нашем примере удаляют лишнее чтение и разметят синтаксические роли <code>S</code>, <code>O</code> и <code>V</code>. Избавьтесь также от предупреждения про разделители.</p>
<div id="479f2e9c" class="cell" data-execution_count="29">
<div class="cell-output cell-output-stdout">
<pre><code>"&lt;Поезд&gt;"
    "поезд" n nom sg S
"&lt;едет&gt;"
    "ехать" v npst p3 sg V
"&lt;в&gt;"
    "в" pr
"&lt;большой&gt;"
    "*большой"
"&lt;город&gt;"
    "город" n acc sg O</code></pre>
</div>
</div>
</div>
</div>
<p>Мы посмотрели далеко не все возможности <code>cg3</code>: в документации можно найти инструкции по созданию новых когорт, добавлению зависимостей и отношений — очень полезное для создания синтаксических корпусов, трибанков.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-bick2013" class="csl-entry" role="listitem">
Bick, Eckhard. 2013. <span>«Using Constraint Grammar for Chunking»</span>. В <em>Proceedings of the 19th Nordic Conference of Computational Linguistics (NODALIDA 2013)</em>, 13–26.
</div>
<div id="ref-bick15" class="csl-entry" role="listitem">
Bick, Eckhard, и Tino Didriksen. 2015. <span>«CG-3 — beyond classical constraint grammar»</span>. В <em>Proceedings of the 20th Nordic Conference of Computational Linguistics (NODALIDA 2015)</em>, 31–39.
</div>
<div id="ref-karlsson1995" class="csl-entry" role="listitem">
Karlsson, Fred, Atro Voutilainen, Juha Heikkilae, и Arto Anttila. 1995. <em>Constraint Grammar: a language-independent system for parsing unrestricted text</em>. Т. 4. Walter de Gruyter.
</div>
<div id="ref-swanson25" class="csl-entry" role="listitem">
Swanson, Daniel Glen. 2025. <span>«Towards Natural Language Explanations of Constraint Grammar Rules»</span>. В <em>Proceedings of the 9th Workshop on Constraint Grammar and Finite State NLP</em>, 28–31.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Скопировано");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Скопировано");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./06_transducer_manipulation.html" class="pagination-link" aria-label="Операции с трансдьюсерами">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Операции с трансдьюсерами</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08_coverage.html" class="pagination-link" aria-label="Метрики качества">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Метрики качества</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>